# ECMAScript 5

## 入门篇

### 导论

#### 什么是 JavaScript 语言？

- JavaScript 是一种轻量级的脚本语言（script language），即它不具备开发操作系统的能力，而是只用来编写控制其他大型应用程序（比如浏览器）的“脚本”。
- JavaScript 是一种嵌入式（embedded）语言，即它适合嵌入更大型的应用程序环境，去调用宿主环境（比如浏览器、Node 项目）提供的底层 API。
- JavaScript 是一种“对象模型”语言。各种宿主环境通过这个模型，描述自己的功能和操作接口，从而通过 JavaScript 控制这些功能。

#### 为什么学习 JavaScript?

- 操作浏览器的能力：它是目前唯一一种通用的浏览器脚本语言，所有浏览器都支持。
- 广泛的使用领域：包括浏览器的平台化、Node、数据库操作、移动平台开发、内嵌脚本语言和跨平台的桌面应用程序等。
- 易学性：学习环境无处不在、简单性、与主流语言的相似性。
- 强大的性能：语法灵活表达能力强、支持编译运行、事件驱动和非阻塞式设计。
- 开放性。
- 社区支持和就业机会。

### 历史

#### 诞生

1990年底，欧洲核能研究组织（CERN）科学家 Tim Berners-Lee，在全世界最大的电脑网络——互联网的基础上，发明了万维网（World Wide Web），从此可以在网上浏览网页文件。最早的网页只能在操作系统的终端里浏览，也就是说只能使用命令行操作，网页都是在字符窗口中显示，非常不方便。

1992年底，美国国家超级电脑应用中心（NCSA）开始开发一个独立的浏览器，叫做 Mosaic。这是人类历史上第一个浏览器，从此网页可以在图形界面的窗口浏览。

1994年10月，NCSA 的一个主要程序员 Marc Andreessen 联合风险投资家 Jim Clark，成立了 Mosaic 通信公司（Mosaic Communications），不久后改名为 Netscape。这家公司的方向，就是在 Mosaic 的基础上，开发面向普通用户的新一代的浏览器 Netscape Navigator。

1994年12月，Navigator 发布了1.0版，市场份额一举超过90%。

Netscape 公司很快发现，Navigator 浏览器需要一种可以嵌入网页的脚本语言，用来控制浏览器行为。当时，网速很慢而且上网费很贵，有些操作不宜在服务器端完成。比如，如果用户忘记填写“用户名”，就点了“发送”按钮，到服务器再发现这一点就有点太晚了，最好能在用户发出数据之前，就告诉用户“请填写用户名”。这就需要在网页中嵌入小程序，让浏览器检查每一栏是否都填写了。

管理层对这种浏览器脚本语言的设想是：功能不需要太强，语法较为简单，容易学习和部署。那一年，正逢 Sun 公司的 Java 语言问世，市场推广活动非常成功。Netscape 公司决定与 Sun 公司合作，浏览器支持嵌入 Java 小程序（后来称为 Java applet）。但是，浏览器脚本语言是否就选用 Java，则存在争论。后来，还是决定不使用 Java，因为网页小程序不需要 Java 这么“重”的语法。但是，同时也决定脚本语言的语法要接近 Java，并且可以支持 Java 程序。这些设想直接排除了使用现存语言，比如 Perl、Python 和 TCL。

1995年，Netscape 公司雇佣了程序员 Brendan Eich 开发这种网页脚本语言。Brendan Eich 有很强的函数式编程背景，希望以 Scheme 语言（函数式语言鼻祖 LISP 语言的一种方言）为蓝本，实现这种新语言。他只用了10天，就设计完成了这种语言的第一版。它是一个大杂烩，语法有多个来源。

- 基本语法：借鉴 C 语言和 Java 语言。
- 数据结构：借鉴 Java 语言，包括将值分成原始值和对象两大类。
- 函数的用法：借鉴 Scheme 语言和 Awk 语言，将函数当作第一等公民，并引入闭包。
- 原型继承模型：借鉴 Self 语言（Smalltalk 的一种变种）。
- 正则表达式：借鉴 Perl 语言。
- 字符串和数组处理：借鉴 Python 语言。

为了保持简单，这种脚本语言缺少一些关键的功能，比如块级作用域、模块、子类型（subtyping）等等，但是可以利用现有功能找出解决办法。这种功能的不足，直接导致了后来 JavaScript 的一个显著特点：对于其他语言，你需要学习语言的各种功能，而对于 JavaScript，你常常需要学习各种解决问题的模式。而且由于来源多样，从一开始就注定，JavaScript 的编程风格是函数式编程和面向对象编程的一种混合体。

Netscape 公司的这种浏览器脚本语言，最初名字叫做 Mocha，1995年9月改为 LiveScript。12月，Netscape 公司与 Sun 公司（Java 语言的发明者和所有者）达成协议，后者允许将这种语言叫做 JavaScript。这样一来，Netscape 公司可以借助 Java 语言的声势，而 Sun 公司则将自己的影响力扩展到了浏览器。

之所以起这个名字，并不是因为 JavaScript 本身与 Java 语言有多么深的关系（事实上，两者关系并不深，详见下节），而是因为 Netscape 公司已经决定，使用 Java 语言开发网络应用程序，JavaScript 可以像胶水一样，将各个部分连接起来。当然，后来的历史是 Java 语言的浏览器插件失败了，JavaScript 反而发扬光大。

1995年12月4日，Netscape 公司与 Sun 公司联合发布了 JavaScript 语言，对外宣传 JavaScript 是 Java 的补充，属于轻量级的 Java，专门用来操作网页。

1996年3月，Navigator 2.0 浏览器正式内置了 JavaScript 脚本语言。

#### JavaScript 与 Java 的关系

JavaScript 是与 Java 有足够的相似性的一种小型的、简单的动态语言。

#### JavaScript 与 ECMAScript 的关系

ECMAScript 是 JavaScript 的规范，JavaScript 是 ECMAScript 的实现。

### 基本语法

#### 语句和表达式

语句（statement）是为了完成某种任务而进行的操作。

```js
var a = 1 + 3;
```

表达式（expression），指一个为了得到返回值的计算式。

```js
1 + 3
```

#### 变量

**概念**

变量是对“值”的具名引用。

```js
var a = 1;
```

变量的声明和赋值，是分开的两个步骤，实际的步骤是下面这样。

```js
var a;
a = 1;
```

如果一个变量没有声明就直接使用，JavaScript 会报错，告诉你变量未定义。

```js
x
// ReferenceError: x is not defined
```

JavaScript 是一种动态类型语言，也就是说，变量的类型没有限制，变量可以随时更改类型。

```js
var a = 1;
a = 'hello';
```

如果使用var重新声明一个已经存在的变量，是无效的。

```js
var x = 1;
var x;
x // 1
```

但是，如果第二次声明的时候还进行了赋值，则会覆盖掉前面的值。

```js
var x = 1;
var x = 2;
// 等同于
var x = 1;
var x;
x = 2;
```

**变量提升**

JavaScript 引擎的工作方式是，先解析代码，获取所有被声明的变量，然后再一行一行地运行。这造成的结果，就是所有的变量的声明语句，都会被提升到代码的头部，这就叫做变量提升（hoisting）。

```js
console.log(a);
var a = 1;
// 实际运行的代码
var a;
console.log(a);
a = 1;
```

## 参考

- [阮一峰 JavaScript 教程](https://www.bookstack.cn/read/javascript-tutorial/README.md)